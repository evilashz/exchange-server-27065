using System;
using Microsoft.Exchange.Data.Mime;

namespace Microsoft.Exchange.Transport.Agent.Malware
{
	// Token: 0x02000030 RID: 48
	internal abstract class StampMalware
	{
		// Token: 0x06000123 RID: 291 RVA: 0x000099B5 File Offset: 0x00007BB5
		public StampMalware()
		{
		}

		// Token: 0x17000040 RID: 64
		// (get) Token: 0x06000124 RID: 292
		public abstract string Name { get; }

		// Token: 0x17000041 RID: 65
		// (get) Token: 0x06000125 RID: 293
		public abstract bool IsServiceStamp { get; }

		// Token: 0x06000126 RID: 294 RVA: 0x000099BD File Offset: 0x00007BBD
		public static StampMalware Create(bool inService)
		{
			if (inService)
			{
				return new StampMalwareService();
			}
			return new StampMalwareEnterprise();
		}

		// Token: 0x06000127 RID: 295 RVA: 0x000099D0 File Offset: 0x00007BD0
		public static StampMalware Find(HeaderList headers)
		{
			Header header = headers.FindFirst("X-MS-Exchange-Organization-AVStamp-Service");
			if (header != null)
			{
				return StampMalware.Create(true);
			}
			header = headers.FindFirst("X-MS-Exchange-Organization-AVStamp-Enterprise");
			if (header != null)
			{
				return StampMalware.Create(false);
			}
			return null;
		}

		// Token: 0x04000138 RID: 312
		public const string ServiceHeaderName = "X-MS-Exchange-Organization-AVStamp-Service";

		// Token: 0x04000139 RID: 313
		public const string EnterpriseHeaderName = "X-MS-Exchange-Organization-AVStamp-Enterprise";

		// Token: 0x0400013A RID: 314
		public const string StampVersion = "1.0";
	}
}
