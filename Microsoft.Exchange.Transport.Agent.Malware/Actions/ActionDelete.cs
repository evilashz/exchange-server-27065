using System;
using Microsoft.Exchange.Data.Transport.Routing;
using Microsoft.Exchange.Diagnostics.Components.MalwareAgent;

namespace Microsoft.Exchange.Transport.Agent.Malware.Actions
{
	// Token: 0x02000006 RID: 6
	internal class ActionDelete : Action
	{
		// Token: 0x06000015 RID: 21 RVA: 0x00002F38 File Offset: 0x00001138
		public override void Execute(ScanContext context, SubmittedMessageEventSource source, QueuedMessageEventArgs args)
		{
			ExTraceGlobals.ActionsTracer.TraceDebug((long)this.GetHashCode(), "Begin ActionDelete.Execute.");
			base.SendSenderNotifications(context, args, ScanAction.Blocked);
			context.ScanActionExecuted = ScanAction.Blocked;
			base.TrackMalwareAgentInfo(context, source);
			source.Delete();
		}

		// Token: 0x04000003 RID: 3
		public static readonly string[] DiagnosticHeaders = new string[]
		{
			"Subject"
		};
	}
}
